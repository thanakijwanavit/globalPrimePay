---

title: Client


keywords: fastai
sidebar: home_sidebar

summary: "client for global prime pay"
description: "client for global prime pay"
nb_path: "nbs/client.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/client.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Client">Client<a class="anchor-link" href="#Client"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Client" class="doc_header"><code>class</code> <code>Client</code><a href="https://github.com/thanakijwanavit/globalPrimePay/tree/main/globalPrimePay/client.py#L13" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Client</code>(<strong><code>pub</code></strong>, <strong><code>secret</code></strong>, <strong><code>endpoint</code></strong>=<em><code>'https://api.globalprimepay.com'</code></em>)</p>
</blockquote>
<p>main client for interface with global prime pay</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get-token">Get token<a class="anchor-link" href="#Get-token"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getCardToken" class="doc_header"><code>getCardToken</code><a href="https://github.com/thanakijwanavit/globalPrimePay/tree/main/globalPrimePay/client.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getCardToken</code>(<strong><code>cardNumber</code></strong>, <strong><code>expirationMonth</code></strong>, <strong><code>expirationYear</code></strong>, <strong><code>securityCode</code></strong>, <strong><code>name</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">sampleKeys</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">getCardToken</span><span class="p">(</span><span class="o">**</span><span class="n">sampleCard</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;card&#39;</span><span class="p">][</span><span class="s1">&#39;token&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;rememberCard&#39;: True, &#39;resultCode&#39;: &#39;00&#39;, &#39;resultMessage&#39;: &#39;Success&#39;, &#39;card&#39;: {&#39;name&#39;: None, &#39;number&#39;: &#39;453501XXXXXX5741&#39;, &#39;expirationMonth&#39;: &#39;05&#39;, &#39;expirationYear&#39;: &#39;28&#39;, &#39;securityCode&#39;: None, &#39;token&#39;: &#39;9513f0e0-aa69-49bc-98b0-afbd82dab52a&#39;, &#39;cardLocation&#39;: &#39;D&#39;, &#39;cardType&#39;: &#39;VIS&#39;}}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Charge-Card">Charge Card<a class="anchor-link" href="#Charge-Card"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@add_method</span><span class="p">(</span><span class="n">Client</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">chargeCard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> 
               <span class="n">amount</span><span class="p">:</span><span class="n">Number</span><span class="p">,</span> 
               <span class="n">referenceNo</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> 
               <span class="n">customerName</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> 
               <span class="n">customerEmail</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> 
               <span class="n">detail</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
               <span class="n">responseUrl</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;https://responseUrl&quot;</span><span class="p">,</span>
               <span class="n">backgroundUrl</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span>  <span class="s2">&quot;https://backgroundUrl&quot;</span><span class="p">,</span>
               <span class="n">otp</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
               <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">dict</span><span class="p">:</span>
  <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
    <span class="s2">&quot;referenceNo&quot;</span><span class="p">:</span> <span class="n">referenceNo</span><span class="p">,</span>
    <span class="s2">&quot;detail&quot;</span><span class="p">:</span> <span class="n">detail</span><span class="p">,</span>
    <span class="s2">&quot;customerName&quot;</span><span class="p">:</span> <span class="n">customerName</span><span class="p">,</span>
    <span class="s2">&quot;customerEmail&quot;</span><span class="p">:</span> <span class="n">customerEmail</span><span class="p">,</span>
    <span class="s2">&quot;card&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;token&quot;</span><span class="p">:</span> <span class="n">token</span>
    <span class="p">},</span>
    <span class="s2">&quot;otp&quot;</span><span class="p">:</span> <span class="n">otp</span><span class="p">,</span>
    <span class="s2">&quot;responseUrl&quot;</span><span class="p">:</span> <span class="n">responseUrl</span><span class="p">,</span>
    <span class="s2">&quot;backgroundUrl&quot;</span><span class="p">:</span> <span class="n">backgroundUrl</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
  <span class="p">}</span>
  
  <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="si">}</span><span class="s1">/v2/tokens/charge&#39;</span>
  <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">secPL</span><span class="p">,</span>
    <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="o">**</span><span class="n">sampleKeys</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="n">cardPayload</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span>
  <span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="s1">&#39;referenceNo&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;TEST123</span><span class="si">{</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
  <span class="s1">&#39;customerName&#39;</span><span class="p">:</span> <span class="s1">&#39;nic&#39;</span><span class="p">,</span>
  <span class="s1">&#39;customerEmail&#39;</span><span class="p">:</span> <span class="s1">&#39;email@gmail.com&#39;</span><span class="p">,</span>
  <span class="s1">&#39;otp&#39;</span><span class="p">:</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span>
  <span class="s1">&#39;detail&#39;</span><span class="p">:</span> <span class="s1">&#39;this is just a test&#39;</span>
<span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chargeCard</span><span class="p">(</span><span class="o">**</span><span class="n">cardPayload</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="n">gbpReferenceNo</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;gbpReferenceNo&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;customerAddress&#39;: None, &#39;amount&#39;: 10, &#39;referenceNo&#39;: &#39;TEST1234975&#39;, &#39;messageToMerchant&#39;: None, &#39;resultCode&#39;: &#39;00&#39;, &#39;customerTelephone&#39;: None, &#39;resultMessage&#39;: &#39;Success&#39;, &#39;customerName&#39;: &#39;nic&#39;, &#39;customerEmail&#39;: &#39;email@gmail.com&#39;, &#39;gbpReferenceNo&#39;: &#39;gbp173512057819&#39;, &#39;merchantDefined5&#39;: None, &#39;detail&#39;: &#39;this is just a test&#39;, &#39;merchantDefined3&#39;: None, &#39;merchantDefined4&#39;: None, &#39;merchantDefined1&#39;: None, &#39;merchantDefined2&#39;: None}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Verify-OTP">Verify OTP<a class="anchor-link" href="#Verify-OTP"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@add_method</span><span class="p">(</span><span class="n">Client</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">verifyOtp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gbpReferenceNo</span><span class="p">):</span>
  <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">&#39;publicKey&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span>
      <span class="s1">&#39;gbpReferenceNo&#39;</span><span class="p">:</span> <span class="n">gbpReferenceNo</span>
  <span class="p">}</span>
  <span class="n">headers3d</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">+</span> <span class="s2">&quot;/v2/tokens/3d_secured&quot;</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers3d</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">verifyOtp</span><span class="p">(</span><span class="n">gbpReferenceNo</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;&lt;!DOCTYPE html&gt;\n\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;GB Prime Pay&lt;/title&gt;\n    &lt;meta charset=&#34;UTF-8&#34; /&gt;\n    &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34; /&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div&gt;Loading...&lt;/div&gt;\n    &lt;div&gt;\n      &lt;form action=&#34;https://simbank.globalprimepay.com/pay/3d_secure&#34; method=&#34;post&#34;&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;MERID&#34; value=&#34;21291800001&#34; /&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;TERMINALID&#34; value=&#34;18060001&#34; /&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;PAN&#34; value=&#34;4535017710535741&#34; /&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;EXPIRYDATE&#34; value=&#34;0528&#34; /&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;CVV2&#34; value=&#34;184&#34; /&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;INVOICENO&#34; value=&#34;2205020023&#34; /&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;AMOUNT&#34; value=&#34;1000&#34; /&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;POSTURL&#34; value=&#34;https://api.globalprimepay.com/web/thanachat_gateway/receive/goback&#34; /&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;POSTURL2&#34; value=&#34;https://api.globalprimepay.com/web/thanachat_gateway/receive/realtime&#34; /&gt;\n        &lt;input type=&#34;hidden&#34; name=&#34;AUTOREDIRECT&#34; value=&#34;Y&#34; /&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n    &lt;script type=&#34;text/javascript&#34; src=&#34;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js&#34;&gt;&lt;/script&gt;\n    &lt;script type=&#34;text/javascript&#34;&gt;\n      $(document).ready(function () {\n        $(\&#39;form\&#39;).submit();\n      });\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HTML(r)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

